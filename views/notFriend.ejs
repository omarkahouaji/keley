<!doctype html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<link href="/css/bootstrap.min.css" rel="stylesheet">
<link href="/css/font-awesome-4.5.0/css/font-awesome.min.css" rel="stylesheet">
<link href="/css/style.css" rel="stylesheet">
<link rel="stylesheet" type="text/css" href="/css/bootstrap-select.css">
<link rel="stylesheet" type="text/css" href="/css/normalize.css">
<link rel="stylesheet" href="/css/basic-styles.css" media="screen">
<link rel="stylesheet" href="/css/header.css" media="screen">
<link rel="stylesheet" href="/css/okayNav.css" media="screen">
<link rel="stylesheet" href="/css/default.date.css" media="screen">
<link rel="stylesheet" href="/css/default.css" media="screen">
<link rel="stylesheet" href="/css/bootstrap-tagsinput.css" media="screen">
<link rel="stylesheet" href="/css/flags.css" />

<script src="/js/jquery.js"></script>
<script src="/js/bootstrap.js"></script>
<script src="/js/picker.js"></script>
<script src="/js/legacy.js"></script>
<script src="/js/picker.date.js"></script>
<script src="/js/canvas-to-blob.min.js"></script>
<script src="/js/bootstrap-tagsinput.js"></script>
<script src="/js/jquery.flagstrap.js"></script>

<script src="/js/jquery.okayNav.js"></script>
</head>
<body class="home">

  <%- include layouts/header.ejs %>
  <main>
    <div class="container">
      <div class="row">
        <%- include layouts/profileNavFriend.ejs %>
        
        <div class="col-md-7">
        <div class="box  box-top">
          <span class="box-title"></span>

<img src="/images/chrolia.svg" width="150px">


<div class="alert alert-warning alert-dismissible" role="alert">
Pour voir le profil de <%=friends_data.first_name+' '+friends_data.last_name%>,envoyez-lui une invitation.
</div>
<!--
  <button ng-show="(user.friend == null && sent == false && user.user_id!=user.id_user && user.notif_type!=2) || refused==true"  ng-click="sendFriendRequest($event,user);sent=true" class="search_block_add_friend btn"><i class=" icon-friends s" ></i><span>Ajouter</span></button>
  -->

  <button style="float: initial;display: none;    border-color: #fff;" class="btn_not_friend  search_block_add_friend btn" id="addafter" onclick="sendFriendRequest()"><i class=" icon-friends s" ></i><span>Ajouter</span></button>


<span id="friend" style="display:none" class="btn_not_friend search_block_friend btn"><i class=" icon-friends s" ></i>Amis</span>


  <% if(notif==false) {%>
  <button style="float: initial;    border-color: #fff;" class="btn_not_friend  search_block_add_friend btn" id="add" onclick="sendFriendRequest()"><i class=" icon-friends s" ></i><span>Ajouter</span></button>
  <button style="float: initial;display:none;    border-color: #fff;" class="search_block_add_friend btn" id="request"><i class=" icon-friends s" ></i><span>Demande envoyée</span></button>


  <% } else if(notif==friends_data.id_user) { %>

                 <button   onclick="addFriend()" class="response btn_not_friend add-btn search_block_friend btn" ng-show="user.notif_type==2&& user.recipient_id==<%-informations.id_user%> && user.friend == null"  type="submit"><i class=" icon-check s"></i></button>

                                  <button onclick="deleteFriend()"  class="response btn_not_friend search-follow search_block_friend  btn" ng-show="user.notif_type==2 && user.recipient_id==<%-informations.id_user%> && user.friend == null"  type="submit" ><i class=" icon-close s"></i></button>





<% } else { %>
  <button style="float: initial;  border-color: #fff;" class="search_block_add_friend btn" id="request"><i class=" icon-friends s" ></i><span>Demande envoyée</span></button>
  <% } %>

      </div>
      </div>


</div>
</div>
</main>



<script type="text/javascript">

function addFriend(){
              //event.preventDefault();
            $.ajax({
              url:'/addFriend',
              type: 'POST',
              data:{
                user_id:<%-informations.id_user%>,
                id:<%=friends_data.id_user%>,
              },
              dataType: 'json',
              success:function(data){
                var json = JSON.parse(data);
                if(json.msg=='success'){   
                    console.log('yes');
                }else{
                    console.log('no :(')
                }
              }
            });
                    $('.response').remove();
        $('#friend').show();
}



        //deleteFriend
        function deleteFriend(){
            event.preventDefault();
            $.ajax({
              url:'/deleteFriend',
              type: 'POST',
              data:{
                user_id:<%-informations.id_user%>,
                id:<%=friends_data.id_user%>
              },
              dataType: 'json',
              success:function(data){
                var json = JSON.parse(data);
                console.log(json);
                if(json.msg=='success'){   
                    console.log('yes');
                }else{
                  console.log('no :(')
                }
              }
            });
        $('.response').remove();
        $('#addafter').show();
         }
         //end


        function sendFriendRequest() {
        //event.preventDefault();
        $.ajax({
          url:'/sendFriendRequest',
          type: 'POST',
          data:{
            sender_id:<%-informations.id_user%>,
            recipient_id:<%=friends_data.id_user%>
          },
          dataType: 'json',
          success:function(data){
            var json = JSON.parse(data);
            if(json.msg=='success'){   
                    console.log('yes');
            }else{
              console.log('no :(')
            }
          }
        });
        $('#add').remove();
        $('#request').show();
      }

    var navigation = $('#nav-main').okayNav();
</script>
</body>
</html>
