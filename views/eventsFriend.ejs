<!doctype html>
<html data-ng-app="App">
  <head>
    <%- include layouts/site.ejs %>
    <title>Ev√©nements</title>
    
    <link rel="stylesheet" href="/css/ngGallery.css">
    <link rel="stylesheet" href="/css/screen.css">
    <script src="/js/angular.min.js"></script>
    <script src="/js/ng-infinite-scroll.js"></script>
    <script src="/js/angular-animate.js"></script>
    <script src="/js/ui-bootstrap.js"></script>
    <script src="/js/ngGallery.js"></script>
    <script src="/js/moment.js"></script>
    <script src="/js/moment-with-locales.js"></script>
    <%- include ../public/js/events_friend.js %>
    <%- include ../public/js/messages.js %>
      </head>
    
    <body class="home"  data-ng-controller="DemoController as ctrl" >
      <%- include layouts/header.ejs %>
      <main>
      <%- include layouts/messages.ejs %>
      <div class="container">
        <div class="row">
          <%- include layouts/profileNavFriend.ejs %>
          <div class="  col-md-7">
            <div class="profil" style="padding: 15px">
              <div id="container"></div>
              <div infinite-scroll='reddit.nextPage()' infinite-scroll-disabled='reddit.busy' infinite-scroll-distance='3'  >
                <div class="events row" ng-init="deleted=false" ng-repeat="event in reddit.events" ng-if="event.chart_privacy != '0' || event.user_id == '<%-informations.id_user%>'">
                  <div  ng-hide="deleted">
                    <div class="row">
                      <div class="col-md-12">
                      </div>
                      <div class="event-header">
                        <div class="event-left">
                          <a ng-href="/event/{{event.id_event}}" class="event-title">{{event.title}}</a>
                          <span class="event-date">aa{{'Le '+dateEvent(event.start_date)}}</span>
                        </div>
                        <div class="event-right">
                          <a ng-href="/chart/{{event.chart_id}}" class="event-chart">{{event.chart_name}}</a>
                          <i ng-class="event.chart_privacy == 0 ? 'icon-private' : event.chart_privacy == 1 ? 'icon-friends' : 'icon-public' "></i>
                          <div ng-init="x = event.note">
                            <uib-rating ng-model="x" max="5" read-only="true" state-on="'green icon-star-filled'" state-off="'green icon-star-empty'" aria-labelledby="custom-icons-1"></uib-rating>
                          </div>
                          
                        </div>
                      </div>
                    </div>
                    <div class="row">
                      <div class="event-description col-md-12">
                        {{event.description}}
                      </div>
                    </div>
                    <div class="row">
                      <div class="event-images" class="popup-gallery">
                        <div thumbs-num="11">
                          <ng-gallery images=event.images ></ng-gallery>
                        </div>
                      </div>
                    </div>
                    <div class="event-comment-like">
                      <div class="like-btn"><span ng-class="event.isLiked==true ? 'red' : ''" ng-click="addLike($event,event);increment(event)"><i class=" icon-heart "></i></span></div>
                      <span class="green" ng-model="likeModel" >{{event.likes.length}}</span>
                      <i class=" icon-heart "></i>
                      <div class="comments-btn" ng-click="show= !show">
                        <span class="green" ng-model="abc" >{{event.comments.length}}</span>
                        <i class=" icon-comment "></i>
                      </div>
                    </div>
                    <form  action="/postComment" method="post">
                      <div class="comments" ng-init="show = false" ng-show="show">
                        <div class="comments-item" ng-repeat="comment in event.comments">
                          <div class="comments-container">
                            <img class="comments-img " ng-src="<%= path_avatar %>/{{comment.user[0].id_user}}/{{comment.user[0].avatar}}" >
                            <h5 class="comments-user-name">{{comment.user[0].first_name}}</h5>
                            <span class="comments-date">{{formatDate(comment.creation_date )}}</span>
                            <p>{{comment.content}}</p>
                          </div>
                        </div>
                        <div class="added"></div>
                        <div class="post-comment">
                          <img class="post-comment-img " src="<%= path_avatar %>/<%=me.id_user%>/<%=me.avatar%>" >
                          <input ng-model="content" id="com-{{$index}}"  type="text" placeholder="Votre commentaire ... "></input>
                          
                          <input ng-click="addComment($event,event,content);content=''"  type="submit" style="position: absolute; left: -9999px"/>
                          
                        </div>
                        
                      </div>
                    </form>
                  </div>
                </div>
                <div ng-show='reddit.busy'><img src="../images/rolling.svg" width="20px"></div>
              </div>
            </div>
          </div>
        </div>
      </div>
      </main>
      <script src="/js/site.js"></script>
      <script type="text/javascript">
      
      $('#myModal').on('shown.bs.modal', function () {
      $('#myInput').focus()
      });
      
      </script>
    </body>
  </html>