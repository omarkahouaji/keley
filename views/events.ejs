<!doctype html>
<html data-ng-app="App">
  <head>
    <title>Mes événements - Immortality</title>
    <%- include layouts/site.ejs %>
    <link rel="stylesheet" href="/css/normalize.css">
    <link href="/css/font-awesome-4.5.0/css/font-awesome.min.css" rel="stylesheet">
    <link rel="stylesheet" href="/css/basic-styles.css">
    <link rel="stylesheet" href="/css/header.css">
    <link rel="stylesheet" href="/css/ngGallery.css">
    <link rel="stylesheet" href="/css/croppie.css" />
    <link rel="stylesheet" href="/css/fileinput.min.css" media="screen">
    <link href="/css/sweetalert2.css" rel="stylesheet">
    <script src="/js/angular.min.js"></script>
    <script src="/js/ng-infinite-scroll.js"></script>
    <script src="/js/angular-animate.js"></script>
    <script src="/js/ui-bootstrap.js"></script>
    <script src="/js/ngGallery.js"></script>
    <script src="/js/moment.js"></script>
    <script src="/js/croppie.js"></script>
    <script src="/js/moment-with-locales.js"></script>
    <script src="/js/sweetalert2.min.js"></script>
    <%- include ../public/js/events.js %>
    <%- include ../public/js/messages.js %>
  </head>

  <body class="home"  data-ng-controller="DemoController as ctrl" >
    <%- include layouts/header.ejs %>
<main>
<%- include layouts/messages.ejs %>
<div class="container">
  <div class="row">
    <%- include layouts/profileNav.ejs %>
    <div class="  col-md-7">
      <div class="profil" style="padding: 15px">
        <ul class="pager">
          <li class="previous">
            <input type="checkbox" id="private-checkbox" data-ng-model='types.private' ng-init="types.private=true" ng-checked="types.private" />
            <label for="private-checkbox"><i class=" icon-private "></i>Privés</label>
          </li>
          <li>
            <input type="checkbox" id="friends-checkbox" data-ng-model='types.friends' ng-init="types.friends=true" ng-checked="types.friends"/>
            <label for="friends-checkbox"><i class=" icon-friends "></i>Amis</label>
          </li>
          <li class="next">
            <input type="checkbox" id="public-checkbox" data-ng-model='types.public' ng-init="types.public=true" ng-checked="types.public"/>
            <label for="public-checkbox"><i class=" icon-public " ></i>Publics</label>
          </li>
        </ul>
        <form action="/create-event">
          <button class="btn  btn-block informations_btn" type="submit"><i class="icon-event x"></i>Ajouter un événement</button>
        </form>
        <div infinite-scroll='reddit.nextPage()' infinite-scroll-disabled='reddit.busy' infinite-scroll-distance='3'  >
          <div class="events row" ng-init="deleted=false" ng-repeat="event in reddit.events | myfilter:types"  ng-hide="deleted" id="event-{{event.id_event}}">
            <div >
              <div class="row">
                <div class="event-header">
                  <div class="event-left">
                    <a ng-href="/event/{{event.id_event}}" class="event-title">{{event.title}}</a>
                    <span class="event-date">{{'Le '+dateEvent(event.start_date)}} </span>
                  </div>
                  <div class="event-right">
                    <a ng-href="/chart/{{event.chart_id}}" class="event-chart">{{event.chart_name}}</a>
                    <i ng-class="event.chart_privacy == 0 ? 'icon-private' : event.chart_privacy == 1 ? 'icon-friends' : 'icon-public' "></i>
                    <div class="dropdown dropdown-event">
                    <button class="dropdown-toggle btn btn-default " type="button" id="dropdownMenu1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
                    <span><i class="fa fa-pencil" style="font-size:18px"></i></span>
                    </button>
                    <ul class="dropdown-menu" aria-labelledby="dropdownMenu1">
                      <li><a ng-href="/editEvent/{{event.id_event}}" >Modifier l'évènement</a></li>
                      <!-- <li><a href="" ng-click="delete($event,event);deleted=true">Supprimer evenement</a></li> -->
                      <li><a href="javascript:" ng-click="delete(event.id_event)">Supprimer l'évènement</a></li>
                    </ul>
                  </div>
                    <div class="event-note" ng-init="x = event.note">
                      <uib-rating ng-model="x" max="5" read-only="true" state-on="'green icon-star-filled'" state-off="'green icon-star-empty'" aria-labelledby="custom-icons-1"></uib-rating>
                    </div>
                  </div>
                </div>
              </div>
              <!--row-->
              <div class="row">
                <div class="event-description col-md-12">
                  {{event.description}}
                </div>
              </div>
              <div class="row">
                <div class="event-images" class="popup-gallery">
                  <div thumbs-num="11">
                    <ng-gallery images=event.images ></ng-gallery>
                  </div>
                </div>
              </div>
              <div class="event-comment-like">
                <div class="like-btn"> <span ng-class="event.isLiked==true ? 'red' : ''" ng-click="addLike($event,event);increment(event)"><i class=" icon-heart "></i></span></div>
                <div>
                  <span class="green" ng-model="likeModel">{{event.likes.length}}</span>
                  <i class=" icon-heart "></i>
                  <div class="comments-btn" ng-click="show= !show">
                    <span class="green" ng-model="abc" >{{event.comments.length}}</span>
                    <i class="icon-comment "></i>
                  </div>
                </div>
              </div>
              <form  action="/postComment" method="post">
                <div class="comments" ng-init="show = false" ng-show="show">
                  <div class="comments-item" ng-repeat="comment in event.comments">
                    <div class="comments-container">
                      <img class="comments-img " ng-src="<%=path_avatar%>/{{comment.user[0].id_user}}/{{comment.user[0].avatar}}" >
                      <h5 class="comments-user-name">{{comment.user[0].first_name}}</h5>
                      <span class="comments-date">{{formatDate(comment.creation_date )}}</span>
                      <p>{{comment.content}}</p>
                    </div>
                  </div>
                  <div class="added"></div>
                  <div class="post-comment">
                    <img class="post-comment-img " src="<%=path_avatar%>/<%=informations.id_user%>/<%=informations.avatar%>" >
                    <input ng-model="content" id="com-{{$index}}"  type="text" placeholder="Votre commentaire ... "></input>
                    <input ng-click="addComment($event,event,content);content=''"  type="submit" style="position: absolute; left: -9999px"/>
                  </div>
                </div>
              </form>
            </div>
          </div>
        </div>
        <div ng-show='reddit.busy'><img src="../images/rolling.svg" width="20px"></div>
      </div>
    </div>
  </div>
</div>
</main>
<script src="/js/site.js"></script>
    <script type="text/javascript">
    $('#events_link').addClass('items_active');
    </script>
    <%- include ../public/js/crop_avatar.js %>
  </body>
</html>
